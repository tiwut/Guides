<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nextcloud on TrueNAS Core - Installation Guide</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .drawing-container {
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--color-glass-border);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .drawing-container svg {
            width: 100%;
            height: auto;
            max-height: 400px;
            filter: drop-shadow(0 0 5px rgba(255, 102, 0, 0.2));
        }
    </style>
</head>
<body class="guide-page">

    <nav id="sidebar">
        <h2>Nextcloud on TrueNAS Core</h2>
        <ul>
            <li><a href="#intro" class="active">Introduction</a></li>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#installation">Installation Guide</a></li>
            <li><a href="#maintenance">Maintenance</a></li>
            <li><a href="../index.html">← Back to Home</a></li>
        </ul>
    </nav>

    <div id="main-content">
        <header>
            <h1>Nextcloud on TrueNAS Core</h1>
            <p>A complete guide to hosting your private cloud on FreeBSD-based TrueNAS Core using iocage jails for maximum stability and performance.</p>
        </header>

        <section id="intro" class="guide-section">
            <h2>Introduction</h2>
            <div class="card-icon">☁️</div>
            <p>
                <strong>Nextcloud</strong> is the industry standard for self-hosted productivity and storage. Running it on <strong>TrueNAS Core</strong> leverages the OpenZFS file system for superior data integrity, compression, and snapshots.
            </p>
            <p>Unlike TrueNAS Scale (which uses Kubernetes/Docker), TrueNAS Core utilizes <strong>FreeBSD Jails</strong>. This guide focuses on the community-standard script method, which offers better long-term stability and easier updates than the official plugin.</p>
        </section>

        <section id="prerequisites" class="guide-section">
            <h2>Prerequisites</h2>
            <ul>
                <li><strong>TrueNAS Core:</strong> Version 12.0 or 13.0+ installed and running.</li>
                <li><strong>Network:</strong> A static IP address reserved for your Nextcloud Jail.</li>
                <li><strong>Domain Name (FQDN):</strong> Required if you plan to access it outside your network or use SSL (e.g., <code>cloud.example.com</code>).</li>
                <li><strong>SSH Access:</strong> Enabled in TrueNAS Services to run the installation script.</li>
            </ul>
            <div class="important">
                <strong>Note:</strong> While plugins exist in the UI, using the command-line script method allows for automated Let's Encrypt SSL certificates and creates a standard FreeBSD stack (AMP/FEMP) that is easier to debug.
            </div>
        </section>
        
        <section id="installation" class="guide-section">
            <h2>Installation Guide</h2>
            <p>We recommend using the widely adopted automated script by <code>danb35</code>. Access your TrueNAS server via SSH and run the following commands:</p>
            
            <h3>1. Download the Script</h3>
            <pre><code class="language-bash">
# Navigate to a temporary directory
cd /tmp

# Clone the repository
git clone https://github.com/danb35/freenas-iocage-nextcloud
cd freenas-iocage-nextcloud
            </code></pre>

            <h3>2. Create the Configuration</h3>
            <p>Create a file named <code>nextcloud-config</code> to define your parameters (Pool name, IP, Gateway, etc.).</p>
            <pre><code class="language-bash">
# Example configuration command
nano nextcloud-config

# Inside the file, add your specific details:
JAIL_IP="192.168.1.50"
DEFAULT_GW_IP="192.168.1.1"
POOL_PATH="/mnt/Tank"
CERT_EMAIL="you@example.com"
HOST_NAME="cloud.example.com"
            </code></pre>

            <h3>3. Run the Installation</h3>
            <p>Execute the script. This will create the Jail, install PHP, MariaDB, NGINX, and Nextcloud.</p>
            <pre><code class="language-bash">
# Run the script with the created config
sudo ./nextcloud-jail.sh nextcloud-config
            </code></pre>
        </section>

        <section id="maintenance" class="guide-section">
            <h2>Maintenance & Best Practices</h2>
            <p>Once your Nextcloud instance is running, follow these rules to keep it healthy:</p>
            
            <div class="warning">
                <strong>Caution:</strong> Always take a ZFS snapshot of your jail before performing upgrades.
            </div>

            <ul>
                <li><strong>Updating Nextcloud:</strong> Use the web updater for minor versions, or the command line updater for major version jumps.</li>
                <li><strong>Updating the Jail:</strong> Run <code>pkg upgrade</code> inside the jail console to keep PHP and the database current.</li>
                <li><strong>Backups:</strong> Configure periodic ZFS Snapshots and Replication tasks in the TrueNAS GUI to back up your Nextcloud dataset to another drive or server.</li>
                <li><strong>Trusted Domains:</strong> If you change your URL, you must edit <code>config/config.php</code> inside the jail to update the trusted domains array.</li>
            </ul>
        </section>
        
        <footer>
            <a href="https://tiwut.de/cookie-banner-information.html">© 2026 Tiwut.de - Legal Notice</a>
        </footer>
    </div>

<script src="../script.js"></script>
</body>
</html>